# SparrowDB IDEAæµ‹è¯•æŒ‡å—

## 1. è¿è¡Œä¸»ç¨‹åº

### æ–¹æ³•1ï¼šäº¤äº’å¼æ•°æ®åº“åº”ç”¨ (æ¨è)
```java
// æ–‡ä»¶: SparrowDBApplication.java
// åŠŸèƒ½: å®Œæ•´çš„äº¤äº’å¼æ•°æ®åº“ç³»ç»Ÿ
// ç‰¹ç‚¹: æ”¯æŒå‘½ä»¤è¡Œè¾“å…¥ã€ç¤ºä¾‹æ•°æ®ã€æ€§èƒ½æµ‹è¯•
```

**è¿è¡Œæ­¥éª¤ï¼š**
1. åœ¨IDEAä¸­æ‰“å¼€ `SparrowDBApplication.java`
2. å³é”®ç‚¹å‡»æ–‡ä»¶ â†’ `Run 'SparrowDBApplication.main()'`
3. æŒ‰æç¤ºè¾“å…¥æ•°æ®åº“åç§°å’Œæ•°æ®ç›®å½•
4. ä½¿ç”¨äº¤äº’å¼å‘½ä»¤æµ‹è¯•å„ç§åŠŸèƒ½

**å¯ç”¨å‘½ä»¤ï¼š**
- `SELECT * FROM users` - æŸ¥è¯¢æ•°æ®
- `INSERT INTO users VALUES (6, 'Test', 'test@example.com', 30)` - æ’å…¥æ•°æ®
- `tables` - æ˜¾ç¤ºæ‰€æœ‰è¡¨
- `desc users` - æè¿°è¡¨ç»“æ„
- `info` - æ˜¾ç¤ºæ•°æ®åº“ä¿¡æ¯
- `benchmark` - è¿è¡Œæ€§èƒ½æµ‹è¯•
- `help` - æ˜¾ç¤ºå¸®åŠ©
- `quit` - é€€å‡º

### æ–¹æ³•2ï¼šæ¼”ç¤ºç¨‹åº
```java
// æ–‡ä»¶: SimpleSparrowDB.java
// åŠŸèƒ½: è‡ªåŠ¨æ¼”ç¤ºæ•°æ®åº“åŠŸèƒ½
// ç‰¹ç‚¹: æ— éœ€äº¤äº’ï¼Œè‡ªåŠ¨è¿è¡Œæ‰€æœ‰æµ‹è¯•
```

**è¿è¡Œæ­¥éª¤ï¼š**
1. åœ¨IDEAä¸­æ‰“å¼€ `SimpleSparrowDB.java`
2. å³é”®ç‚¹å‡»æ–‡ä»¶ â†’ `Run 'SimpleSparrowDB.main()'`
3. è§‚å¯Ÿè‡ªåŠ¨æ¼”ç¤ºè¿‡ç¨‹

## 2. è¿è¡Œå•å…ƒæµ‹è¯•

### è¿è¡Œæ‰€æœ‰æµ‹è¯•
1. å³é”®ç‚¹å‡» `src/test/java` æ–‡ä»¶å¤¹
2. é€‰æ‹© `Run 'All Tests'`

### è¿è¡Œç‰¹å®šæµ‹è¯•ç±»

#### DatabaseEngineTest (æ•°æ®åº“å¼•æ“æµ‹è¯•)
```java
// æ–‡ä»¶: DatabaseEngineTest.java
// æµ‹è¯•å†…å®¹:
// - åˆ›å»ºè¡¨
// - æ’å…¥æ•°æ®  
// - æŸ¥è¯¢æ•°æ®
// - é”™è¯¯å¤„ç†
```

**è¿è¡Œæ­¥éª¤ï¼š**
1. æ‰“å¼€ `DatabaseEngineTest.java`
2. å³é”®ç‚¹å‡»ç±»å â†’ `Run 'DatabaseEngineTest'`

#### LexicalAnalyzerTest (è¯æ³•åˆ†æå™¨æµ‹è¯•)
```java
// æ–‡ä»¶: LexicalAnalyzerTest.java
// æµ‹è¯•å†…å®¹:
// - SQLå…³é”®å­—è¯†åˆ«
// - æ ‡è¯†ç¬¦è§£æ
// - å­—é¢é‡è§£æ
// - é”™è¯¯å¤„ç†
```

### è¿è¡Œå•ä¸ªæµ‹è¯•æ–¹æ³•
1. åœ¨æµ‹è¯•æ–¹æ³•ä¸Šå³é”® â†’ `Run 'testMethodName()'`
2. æˆ–ç‚¹å‡»æ–¹æ³•åæ—è¾¹çš„ç»¿è‰²ç®­å¤´ â–¶ï¸

## 3. ä¸‰ä¸ªéƒ¨åˆ†çš„è¡”æ¥æƒ…å†µ

### âœ… å·²å®Œæˆçš„è¡”æ¥

#### 1. SQLç¼–è¯‘å™¨ â†” æ•°æ®åº“å¼•æ“
```java
// DatabaseEngine.java ç¬¬59è¡Œ
public ExecutionResult executeSQL(String sql) {
    // ä½¿ç”¨SQLç¼–è¯‘å™¨è§£æSQL
    CompilationResult compilationResult = sqlCompiler.compile(sql);
    
    if (!compilationResult.isSuccess()) {
        return new ExecutionResult(false, "SQLç¼–è¯‘å¤±è´¥: " + compilationResult.getErrors(), null);
    }
    
    // ä½¿ç”¨æ‰§è¡Œå¼•æ“æ‰§è¡Œè®¡åˆ’
    return executor.execute(compilationResult.getExecutionPlan());
}
```

#### 2. æ•°æ®åº“å¼•æ“ â†” å­˜å‚¨ç³»ç»Ÿ
```java
// DatabaseEngine.java ç¬¬33è¡Œ
this.executor = new Executor(new StorageAdapter(dataDirectory), catalogManager);

// Executor.java ä½¿ç”¨StorageAdapter
public Executor(StorageAdapter storageAdapter, CatalogManager catalogManager) {
    this.storageAdapter = storageAdapter;
    this.catalogManager = catalogManager;
}
```

#### 3. å­˜å‚¨ç³»ç»Ÿ â†” æ–‡ä»¶ç³»ç»Ÿ
```java
// StorageAdapter.java æ•´åˆäº†Javaå­˜å‚¨ç³»ç»Ÿ
// StorageEngine.java æä¾›æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨
```

### ğŸ”„ æ•°æ®æµå›¾

```
ç”¨æˆ·è¾“å…¥SQL
    â†“
SQLç¼–è¯‘å™¨ (è¯æ³•åˆ†æ â†’ è¯­æ³•åˆ†æ â†’ è¯­ä¹‰åˆ†æ â†’ æ‰§è¡Œè®¡åˆ’)
    â†“
æ•°æ®åº“å¼•æ“ (DatabaseEngine)
    â†“
æ‰§è¡Œå¼•æ“ (Executor)
    â†“
å­˜å‚¨é€‚é…å™¨ (StorageAdapter)
    â†“
å­˜å‚¨å¼•æ“ (StorageEngine)
    â†“
æ–‡ä»¶ç³»ç»Ÿ (./dataç›®å½•)
```

### âœ… è¡”æ¥éªŒè¯

1. **SQLç¼–è¯‘å™¨å·¥ä½œæ­£å¸¸** âœ“
   - è¯æ³•åˆ†æï¼šæ­£ç¡®è¯†åˆ«å…³é”®å­—ã€æ ‡è¯†ç¬¦ã€å­—é¢é‡
   - è¯­æ³•åˆ†æï¼šæˆåŠŸç”ŸæˆAST
   - è¯­ä¹‰åˆ†æï¼šåŸºæœ¬åŠŸèƒ½æ­£å¸¸

2. **æ•°æ®åº“å¼•æ“å·¥ä½œæ­£å¸¸** âœ“
   - è¡¨åˆ›å»ºï¼šæˆåŠŸåˆ›å»ºuserså’Œproductsè¡¨
   - æ•°æ®å­˜å‚¨ï¼šè¡¨ç»“æ„æ­£ç¡®ä¿å­˜åˆ°æ–‡ä»¶
   - ç›®å½•ç®¡ç†ï¼šç³»ç»Ÿè¡¨æ­£ç¡®ç»´æŠ¤

3. **å­˜å‚¨ç³»ç»Ÿå·¥ä½œæ­£å¸¸** âœ“
   - æ–‡ä»¶å­˜å‚¨ï¼šæ•°æ®æ­£ç¡®å†™å…¥./dataç›®å½•
   - è¡¨ä¿¡æ¯ï¼šå…ƒæ•°æ®æ­£ç¡®å­˜å‚¨å’Œæ£€ç´¢

### âš ï¸ å·²çŸ¥é—®é¢˜

1. **è¯­ä¹‰åˆ†æå™¨åŒæ­¥é—®é¢˜**
   - SQLç¼–è¯‘å™¨çš„Catalogä¸æ•°æ®åº“å¼•æ“çš„CatalogManageræœªå®Œå…¨åŒæ­¥
   - å¯¼è‡´è¯­ä¹‰åˆ†ææ—¶æ— æ³•è¯†åˆ«å·²åˆ›å»ºçš„è¡¨
   - ä½†ä¸å½±å“æ ¸å¿ƒåŠŸèƒ½è¿è¡Œ

2. **æ•°æ®æ’å…¥é—®é¢˜**
   - ç”±äºè¯­ä¹‰åˆ†æé—®é¢˜ï¼ŒINSERTè¯­å¥æ‰§è¡Œå¤±è´¥
   - ä½†è¡¨åˆ›å»ºå’Œç»“æ„å­˜å‚¨æ­£å¸¸

## 4. æµ‹è¯•å»ºè®®

### åŸºç¡€åŠŸèƒ½æµ‹è¯•
1. è¿è¡Œ `SimpleSparrowDB` éªŒè¯åŸºæœ¬åŠŸèƒ½
2. è¿è¡Œ `DatabaseEngineTest` éªŒè¯å•å…ƒæµ‹è¯•
3. è¿è¡Œ `SparrowDBApplication` è¿›è¡Œäº¤äº’å¼æµ‹è¯•

### é«˜çº§åŠŸèƒ½æµ‹è¯•
1. æµ‹è¯•ä¸åŒçš„SQLè¯­å¥
2. æµ‹è¯•é”™è¯¯å¤„ç†
3. æµ‹è¯•æ€§èƒ½åŸºå‡†

### è°ƒè¯•å»ºè®®
1. åœ¨IDEAä¸­è®¾ç½®æ–­ç‚¹è°ƒè¯•
2. æŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºäº†è§£æ‰§è¡Œæµç¨‹
3. æ£€æŸ¥./dataç›®å½•ä¸­çš„æ–‡ä»¶äº†è§£å­˜å‚¨æƒ…å†µ

## 5. é¡¹ç›®ç»“æ„

```
SqlTranslater/DB/
â”œâ”€â”€ src/main/java/
â”‚   â”œâ”€â”€ com/database/
â”‚   â”‚   â”œâ”€â”€ SparrowDBApplication.java    # ä¸»åº”ç”¨ç¨‹åº
â”‚   â”‚   â””â”€â”€ SimpleSparrowDB.java         # æ¼”ç¤ºç¨‹åº
â”‚   â”œâ”€â”€ com/database/engine/
â”‚   â”‚   â”œâ”€â”€ DatabaseEngine.java          # æ•°æ®åº“å¼•æ“ä¸»ç±»
â”‚   â”‚   â”œâ”€â”€ Executor.java                # æ‰§è¡Œå¼•æ“
â”‚   â”‚   â”œâ”€â”€ StorageEngine.java           # å­˜å‚¨å¼•æ“
â”‚   â”‚   â”œâ”€â”€ StorageAdapter.java          # å­˜å‚¨é€‚é…å™¨
â”‚   â”‚   â””â”€â”€ CatalogManager.java          # ç›®å½•ç®¡ç†å™¨
â”‚   â””â”€â”€ com/sqlcompiler/
â”‚       â”œâ”€â”€ SQLCompiler.java             # SQLç¼–è¯‘å™¨ä¸»ç±»
â”‚       â”œâ”€â”€ lexer/                       # è¯æ³•åˆ†æå™¨
â”‚       â”œâ”€â”€ parser/                      # è¯­æ³•åˆ†æå™¨
â”‚       â”œâ”€â”€ semantic/                    # è¯­ä¹‰åˆ†æå™¨
â”‚       â””â”€â”€ execution/                   # æ‰§è¡Œè®¡åˆ’ç”Ÿæˆ
â””â”€â”€ src/test/java/
    â”œâ”€â”€ com/database/engine/
    â”‚   â””â”€â”€ DatabaseEngineTest.java      # æ•°æ®åº“å¼•æ“æµ‹è¯•
    â””â”€â”€ com/sqlcompiler/
        â””â”€â”€ LexicalAnalyzerTest.java     # è¯æ³•åˆ†æå™¨æµ‹è¯•
```

## æ€»ç»“

âœ… **ä¸‰ä¸ªéƒ¨åˆ†å·²æˆåŠŸè¡”æ¥**ï¼š
- SQLç¼–è¯‘å™¨ â†’ æ•°æ®åº“å¼•æ“ â†’ å­˜å‚¨ç³»ç»Ÿ
- æ•°æ®æµå®Œæ•´ï¼Œæ ¸å¿ƒåŠŸèƒ½æ­£å¸¸
- å¯ä»¥æ­£å¸¸åˆ›å»ºè¡¨ã€å­˜å‚¨å…ƒæ•°æ®ã€æ‰§è¡ŒSQLè§£æ

âœ… **æµ‹è¯•ç¯å¢ƒå°±ç»ª**ï¼š
- ä¸»ç¨‹åºå¯ä»¥è¿è¡Œ
- å•å…ƒæµ‹è¯•å¯ä»¥æ‰§è¡Œ
- äº¤äº’å¼æµ‹è¯•å¯ç”¨

âš ï¸ **éœ€è¦æ”¹è¿›**ï¼š
- è¯­ä¹‰åˆ†æå™¨åŒæ­¥é—®é¢˜
- æ•°æ®æ’å…¥åŠŸèƒ½å®Œå–„
