# Java Storage System

这是用Java语言重新实现的数据库存储系统，包含了页式存储管理、缓存机制、并发控制等核心功能。

## 项目结构

```
JavaStorageSystem/
├── Page.java                 # 页结构类
├── DiskManager.java          # 磁盘管理器
├── CacheStats.java           # 缓存统计信息
├── ReplacementPolicy.java    # 替换策略枚举
├── BufferPoolManager.java    # 缓冲池管理器
├── StorageEngine.java        # 存储引擎
├── StorageSystemTest.java    # 测试类
├── compile_and_run.bat       # 编译运行脚本
└── README.md                 # 说明文档
```

## 核心功能

### 1. 页式存储管理
- **Page类**: 表示4KB大小的页面，包含页面ID、数据和元数据
- **DiskManager类**: 负责页面的磁盘I/O操作，支持页面分配、读写、释放

### 2. 缓存机制
- **BufferPoolManager类**: 管理页面缓存，支持LRU和FIFO替换策略
- **CacheStats类**: 统计缓存命中率、未命中次数等性能指标

### 3. 并发控制
- 使用ReentrantReadWriteLock实现读写锁
- 支持多线程并发访问
- 线程安全的数据结构

### 4. 存储引擎
- **StorageEngine类**: 提供统一的存储访问接口
- 支持表页操作、记录存储和读取
- 数据持久化功能

## 替换策略

- **LRU (Least Recently Used)**: 最近最少使用策略
- **FIFO (First In First Out)**: 先进先出策略

## 测试功能

测试类包含以下测试用例：

1. **基本页操作测试**: 页面分配、数据读写、释放
2. **缓存替换策略测试**: 测试LRU和FIFO替换策略
3. **并发访问测试**: 多线程并发访问页面
4. **表页操作测试**: 记录存储和读取
5. **数据持久化测试**: 跨会话数据保持
6. **FIFO替换策略测试**: 专门测试FIFO策略

## 编译和运行

### 方法1: 使用批处理脚本
```bash
compile_and_run.bat
```

### 方法2: 手动编译运行
```bash
# 编译
javac *.java

# 运行测试
java StorageSystemTest
```

## 系统要求

- Java 8 或更高版本
- Windows/Linux/macOS 操作系统

## 性能特性

- 页面大小: 4KB
- 支持可配置的缓冲池大小
- 缓存命中率统计
- 线程安全的并发访问
- 数据持久化存储

## 输出示例

程序运行时会显示：
- 页面分配和释放信息
- 缓存命中/未命中日志
- 页面刷新日志
- 缓存统计信息
- 测试结果

## 与C++版本的对比

Java版本相比C++版本的优势：
- 更好的内存管理（自动垃圾回收）
- 更简洁的代码结构
- 内置的并发支持
- 跨平台兼容性
- 更丰富的标准库

Java版本保持了与C++版本相同的核心功能和接口设计。
